<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="motus">
<title>Vanishing bearings • motus</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Vanishing bearings">
<meta property="og:description" content="motus">
<meta property="og:image" content="https://motuswts.github.io/motus/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-dark" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">motus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">6.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/motus.html">Get started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01-introduction.html">Chapter 1 - Introduction</a>
    <a class="dropdown-item" href="../articles/02-installing-packages.html">Chapter 2 - Installing packages</a>
    <a class="dropdown-item" href="../articles/03-accessing-data.html">Chapter 3 - Accessing detections data</a>
    <a class="dropdown-item" href="../articles/04-deployments.html">Chapter 4 - Tag and receiver deployments</a>
    <a class="dropdown-item" href="../articles/05-data-cleaning.html">Chapter 5 - Data Cleaning</a>
    <a class="dropdown-item" href="../articles/06-exploring-data.html">Chapter 6 - Exploring detections data</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/troubleshooting.html">Troubleshooting</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MotusWTS/motus/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Vanishing bearings</h1>
                        <h4 data-toc-skip class="author">Ana Morales and
Tara Crewe</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MotusWTS/motus/blob/HEAD/vignettes/articles/vanishing-bearings.Rmd" class="external-link"><code>vignettes/articles/vanishing-bearings.Rmd</code></a></small>
      <div class="d-none name"><code>vanishing-bearings.Rmd</code></div>
    </div>

    
    
<blockquote>
<p>This article was contributed by Ana Morales and Tara Crewe using data
collected by Morbey et al. (2017) (see <a href="01-introduction.html#sample-datasets">sample data</a>), and with
financial support from a NSERC CREATE Environmental Innovation Program
internship awarded to A.M. through McGill University, with partner Birds
Canada (T.C.).</p>
</blockquote>
<p>Estimating the orientation of a bird departing a stopover site may be
key in certain migration studies. In the context of an automated
radio-telemetry study, the estimated departure direction is often called
a vanishing bearing (Sjöberg and Nilsson 2015). The ability to use
characteristics of signal detections to estimate the vanishing bearing
of a migrating animal is particularly important at sites where
additional stations are not available to capture the flight path
following departure from a stopover site.</p>
<p>Sjöberg and Nilsson (2015) calculated vanishing bearings using
ordinary circular statistics to estimate the mean of the receiving
antenna bearings over the last 5-10 minutes of detections, with the
bearing of each detection weighted by strength of the signal. In other
words, every signal detected was a vector pointing in the direction of
the receiving antenna, with the length of the vector represented by
signal strength. A stronger signal would therefore get a longer vector
and a higher weight than a weaker signal.</p>
<p>This chapter will show you how to estimate the departure bearing of
your tagged birds using Sjöberg and Nilsson’s method. You can modify
these scripts to work with your own data, or use the sample data
provided. Before you begin, there are a few assumptions and potential
weaknesses you should be aware of:</p>
<div class="section level2">
<h2 id="things-to-be-aware-of">Things to be aware of<a class="anchor" aria-label="anchor" href="#things-to-be-aware-of"></a>
</h2>
<ol style="list-style-type: decimal">
<li>
<strong>This method assumes that the tagged animal is departing from
the general location of the receiving station, and moving radially away
from the station</strong>.</li>
</ol>
<p>It is really important to note that this method <strong>WILL NOT
WORK</strong> unless this assumption is met. Because tagged individuals
most likely aren’t departing from the exact location of the receiver
station, they should be considered coarse estimates of departure
orientation.</p>
<p>The deviation between estimated vanishing bearings and actual
departure orientation that results from birds departing from locations
removed from a station is called parallax error. Parallax error can be
minimized by analyzing only departures in which we can be confident from
signal strength characteristics that an individual departed from fairly
close to the receiving station. Using radar data, Sjöberg and Nilsson
(2015) estimated parallax error to be +- 10 degrees when the bird
departed close to the station.</p>
<p>Manual telemetry can be used to determine the precise location of an
individual during stopover. In the absence of known location, a good way
to know if an individual departed from the general location of a
receiving station is to look at the pattern of detections pre- and
post-departure. If an individual departs from near a station, the data
will show clear detection patterns by at least two different antennas
prior to and during departure. The following plots use data collected
for tagged warblers in spring 2014 and 2015 by Morbey et al. (2017), and
show examples of a) a tag with a clear departure, and b) a tag that does
not show a clear departure; more information on the data can be found in
<a href="01-introduction.html#sample-datasets">Chapter 1’s Sample data
section</a> and the <a href="#load-the-sample-data">Load the sample data
section</a> below:</p>
<ol style="list-style-type: lower-alpha">
<li>
<strong>Good departure</strong>: you can see that the bird stayed in
the vicinity of the Old Cut station during stopover, as shown by
increased signal variation during the day, and decreased signal
variation during the night. On the night of departure, the tag shows the
usual decrease in activity at night, followed by an increase of activity
at around 02:30 am as it departs; the tag stops being detected by the
Old Cut’s station soon after, and is then detected by other nearby
receivers during its departure flight:</li>
</ol>
<p><img src="images/vanishBearing_goodDetection.png" width="60%" style="display: block; margin: auto;"></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>
<strong>Unclear departure</strong>: this bird was not detected by
the Old Cut station for quite a while, and was only detected during an
apparent flyover; signal characteristics do not support a clear
departure from the station. In this case, we do not know how far the
bird was from the station during the flyby. We caution against using
examples like this to estimate vanishing bearings:</li>
</ol>
<p><img src="images/vanishBearing_badDetection.png" width="60%" style="display: block; margin: auto;"></p>
<ol start="2" style="list-style-type: decimal">
<li><strong>The more closely spaced the antennas on a station, the
greater the resolution to estimate an accurate vanishing
bearing.</strong></li>
</ol>
<p>At the Old Cut field station, three antennas were spaced 120 degrees
apart in 2014, and 90 degrees apart in 2015 (facing approximately east,
north and west). In both years we calculated a coarse departure bearing
using the mean of station-to-station bearings for warblers that were
detected by multiple stations during departure. This gave us a known
departure direction. We then calculated vanishing bearings to
compare.</p>
<p>The following is a figure showing the estimated coarse and vanishing
bearing for a warbler departing northwards from Old Cut in spring 2014,
when the 3 antennas were spaced 120 degrees apart. The red line
represents the estimated vanishing bearing of tag ID 277. The blue line
represents the average coarse bearing based on detections from other
stations (red points):</p>
<p><img src="images/vanishBearing2014.png" width="60%" style="display: block; margin: auto;"></p>
<p>In the example below, estimated coarse and vanishing bearings are
shown for a warbler departing to the north in spring 2015, when Old
Cut’s antennas were spaced 90 degrees apart. We can see that the
estimated vanishing bearing is pretty close to the coarse bearing
estimate.</p>
<p><img src="images/vanishBearing2015.png" width="60%" style="display: block; margin: auto;"></p>
<p>Overall, mean deviation between coarse and vanishing bearings was
higher in 2014 (n = 14 departures) when antennas were spaced 120 degrees
apart, than in 2015 (n = 12 departures) when antennas were spaced 90
degrees apart:</p>
<p><img src="images/vanishBearingDeviation.png" width="60%" style="display: block; margin: auto;"></p>
<p>This suggests that stations with closer spaced antennas yield more
accurate vanishing bearings. If the estimation of vanishing bearings is
a primary goal of your research, we suggest spacing antennas 60 degrees
apart, as in Sjöberg and Nilsson (2015).</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>For receivers with negative signal strength values, weights
need to be normalized</strong></li>
</ol>
<p>When calculating weighted circular means, negative weights cannot be
used. We therefore recommend normalizing the signal strength values by
subtracting the minimum signal strength, and dividing by the difference
between min and max signal strength, i.e., using
<code>sig.norm = (sig - min(sig))/(max(sig)-min(sig))</code>. Further,
we suggest using the min and max signal strength at a station, across
<strong>all data</strong> collected by the station, so that the full
range of potential signal strength values are used in the normalization
equation. We found that normalizing using the min and max signal
strength for an individual departure can result in spurious vanishing
bearing estimates if the range in signal strengths observed was not
large. Using the full range of signal strength values in a project
database will avoid this.</p>
</div>
<div class="section level2">
<h2 id="estimate-vanishing-bearings-step-by-step">Estimate vanishing bearings: step-by-step<a class="anchor" aria-label="anchor" href="#estimate-vanishing-bearings-step-by-step"></a>
</h2>
<p>We now walk through how to estimate vanishing bearings in the
following steps:</p>
<ol style="list-style-type: decimal">
<li>Load required R packages</li>
<li>Load the data</li>
<li>Select individuals that show clear departures from the station</li>
<li>Get departure time for each individual</li>
<li>Estimate vanishing bearings</li>
<li>Plot vanishing bearing on a map</li>
</ol>
<div class="section level3">
<h3 id="load-the-required-packages">Load the required packages<a class="anchor" aria-label="anchor" href="#load-the-required-packages"></a>
</h3>
<p>First install the following packages with
<code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code> (see <a href="02-installing-packages.html">Chapter 2 - Installing packages</a>
for help), then load them:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">circular</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://motuswts.github.io/motus/">motus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paleolimbot.github.io/ggspatial/" class="external-link">ggspatial</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Make sure working in UTC </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>TZ <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-the-sample-data">Load the sample data<a class="anchor" aria-label="anchor" href="#load-the-sample-data"></a>
</h3>
<p>The sample data used in this chapter includes the detections of three
Magnolia Warblers that were tagged at the Old Cut field research station
of the Long Point Bird Observatory in Ontario, Canada, by Morbey et
al. (2017). The warblers were tagged and released in spring 2015.</p>
<p>The sample data are included in the <code>motusData</code> R package
as the “vanishBearing.rda” file. In order to access these data, you will
need to first <a href="02-installing-packages.html">install</a> the
<code>motusData</code> package, <em>prior</em> to running the code in
this chapter:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load the motusData package, which contains the sample data for this chapter</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">motusData</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Load the sample data we provided from 3 individual warblers departing Old Cut</span></span>
<span><span class="co"># during the Spring of 2015.</span></span>
<span></span>
<span><span class="co"># We also do a couple manipulations here, to reorder the levels of the</span></span>
<span><span class="co"># recvSiteName factor, and order the data by time.</span></span>
<span></span>
<span><span class="va">df_vanish</span> <span class="op">&lt;-</span> <span class="va">vanishBearing</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">ts</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>recvSiteName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">recvSiteName</span>, <span class="va">recvLat</span><span class="op">)</span>,</span>
<span>         motusTagID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">motusTagID</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># order sites by latitude</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="co"># arrange bytime</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="select-individuals-that-show-clear-departure-detections">Select individuals that show clear departure detections<a class="anchor" aria-label="anchor" href="#select-individuals-that-show-clear-departure-detections"></a>
</h3>
<p>First, we subset the data to the individuals that showed clear
departures from the stopover site of interest. In fact, the sample data
only includes three departures of birds we <em>know</em> have clear
departures from Old Cut, but we show this step here regardless!</p>
<p>By selecting only clear departures, we make sure that the bird
departed from nearby the station, minimizing the potential for parallax
error. We look for clear departures by first plotting latitude against
time. In this case, we can see the birds departing north past several
stations:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_vanish</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">recvLat</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">recvSiteName</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">motusTagID</span>, scales <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="vanishing-bearings_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>We also make sure that the bird was being detected by several
antennas at once during departure; if detections are on only one
antenna, the vanishing bearing will simply be the direction of the lone
antenna with detections. We plot signal strength by time for a subset of
the data, to show the last few hours of detections of the bird at Old
Cut. Let’s try this with tag # 16823 from our sample data:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">df_vanish</span>, <span class="va">motusTagID</span> <span class="op">==</span> <span class="fl">16823</span>, <span class="va">time</span> <span class="op">&gt;</span> <span class="st">"2015-05-30 00:00:00"</span><span class="op">)</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">sig</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">port</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">recvSiteName</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span></code></pre></div>
<p><img src="vanishing-bearings_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>We can see the typical detection pattern of a bird departing from a
site, shown by a decrease in movement (beginning to roost) at around
00:25 UTC, followed by an increase in activity and departure from the
site later in the night after 03:00 UTC. Soon after leaving the site, it
gets detected by five other stations further north. Because this bird
was detected before and during departure, we can assume it has departed
from somewhat close to the Old Cut station.</p>
<p>With your own data, look at plots like these for each of your tagged
individuals, and for the purpose of vanishing bearings, remove any
individuals that don’t have a clear departure.</p>
</div>
<div class="section level3">
<h3 id="obtain-departure-times">Obtain departure times<a class="anchor" aria-label="anchor" href="#obtain-departure-times"></a>
</h3>
<p>In order to estimate vanishing bearings based on the signal strength
of departure detections, we must first determine the approximate time
that the bird started its departure flight. For now, the best way to do
this is by manually going through each set of detections from each bird
and obtaining the approximate time by plotting the time versus signal
strength.</p>
<p>Continuing with tag 16823, let’s find the departure time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">df_vanish</span>, <span class="va">motusTagID</span> <span class="op">==</span> <span class="fl">16823</span><span class="op">)</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">sig</span>, colour<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">antBearing</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">recvSiteName</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span></code></pre></div>
<p><img src="vanishing-bearings_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>We can see the complete set of detections of tag 16823 for Old Cut
and other stations this bird was detected at post-departure.</p>
<p>We then subset the plot in order to zoom in to the last few minutes
of detections at Old Cut, which is where the bird is departing from. By
zooming in we can find the exact departure time.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">df_vanish</span>, </span>
<span>                     <span class="va">motusTagID</span> <span class="op">==</span> <span class="fl">16823</span>,  </span>
<span>                     <span class="va">time</span> <span class="op">&gt;</span> <span class="st">"2015-05-30 03:03:00"</span>,  </span>
<span>                     <span class="va">time</span> <span class="op">&lt;</span> <span class="st">"2015-05-30 03:10:00"</span><span class="op">)</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">sig</span>, colour<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">antBearing</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="vanishing-bearings_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>In this case, we can see an increase in signal strength beginning at
about 3:04 for the 90 and 260 degree antennas at Old Cut. These reach a
peak in signal strength at about 3:04:59, after which signal strength
declines. This suggests that the bird was likely south of the station
when it began it’s departure - signal strength increased and peaked as
it passed through the antenna beams, and then declined again as the bird
moved away (north) from the Old Cut station. We choose the peak signal
strength, i.e., 3:04:59 as the departure time for this bird, to exclude
those detections where the bird was likely moving towards the station;
we would not want the ‘approaching’ station signals to contribute to the
vanishing bearing, because it assumes the bird is moving radially away
from the station.</p>
<p>We create a dataframe with the departure times of each bird and their
motusTagIDs, to use later for data filtering. We add departure times for
the other two birds in the sample dataset; if you are keen, you can try
the plots above on tags 16897 and 16791 to see how we came up with those
departure times:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## create dataframe and assign column names</span></span>
<span><span class="va">dep_16823</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">16823</span>, <span class="st">"2015-05-30 03:04:59"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## create dataframes for the other two tags:</span></span>
<span><span class="va">dep_16867</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">16867</span>, <span class="st">"2015-05-29 01:56:00"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dep_16791</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">16791</span>, <span class="st">"2015-05-08 02:41:40"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## put them all together</span></span>
<span><span class="va">df_departTime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dep_16823</span>, <span class="va">dep_16867</span>, <span class="va">dep_16791</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_departTime</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"motusTagID"</span>, <span class="st">"time_depart"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## convert time to posixCT using Lubridate functionality</span></span>
<span><span class="va">df_departTime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">df_departTime</span>, time_depart <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="va">time_depart</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_departTime</span></span></code></pre></div>
<pre><code><span><span class="co">##   motusTagID         time_depart</span></span>
<span><span class="co">## 1      16823 2015-05-30 03:04:59</span></span>
<span><span class="co">## 2      16867 2015-05-29 01:56:00</span></span>
<span><span class="co">## 3      16791 2015-05-08 02:41:40</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## optionally, save to .RDS file to preserve time structure (you could save to</span></span>
<span><span class="co">## .csv, but time structure will not be preserved) not run here:</span></span>
<span></span>
<span><span class="co"># saveRDS(df_departTime, file = "./data/departureTimes.RDS")</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculate-vanishing-bearings-for-individuals-with-departure-times">Calculate vanishing bearings for individuals with departure
times<a class="anchor" aria-label="anchor" href="#calculate-vanishing-bearings-for-individuals-with-departure-times"></a>
</h3>
<p>Now, we subset our data to one individual to calculate its vanishing
bearing.</p>
<p>We will continue with the same individual, <code>motusTagID</code>
16823, using all detections after and including our specified departure
time:</p>
<p>Now that we have only the post-departure detections for the bird we
are interested in, we calculate its vanishing bearing.</p>
<p>First, we normalize the signal strengths, as discussed above, using
the minimum and maximum observed signal strength across all data
collected by the receiver. If there are differences in the range of
signal strengths detected by antennas on a receiver, you might want to
instead normalize by antenna. We do not have access to the entire
database with the sample data, but we know the minimum and maximum
signal strengths detected at the Old Cut stations are -78.0691 and
-17.8707, respectively.</p>
<p>We then calculate a weighted mean of departure angle across the
entire departure period using the circular function. The numbers
-78.0691 and -17.8707 are the minimum and maximum signal strength values
for the Old Cut station. If using your own data, make sure you instead
use the min and max signal strength for your station (using the full
stations’s data, not only from the subset of the tags you are
analyzing).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Merge sample data with departure times, subset data, and calculate vanishing bearing</span></span>
<span></span>
<span><span class="co">## Note that we use the recvSiteName to specify the departure station of</span></span>
<span><span class="co">## interest. Depending on whether the station has moved or changed names with</span></span>
<span><span class="co">## deployments, recvDeployID might be more appropriate.</span></span>
<span></span>
<span><span class="va">depart.station</span> <span class="op">&lt;-</span> <span class="st">"Old Cut"</span></span>
<span><span class="va">min.sig</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">78.0691</span> <span class="co"># normally max/min sig comes from the complete raw data for a station</span></span>
<span><span class="va">max.sig</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">17.8707</span></span>
<span></span>
<span><span class="co"># in this case, right join should drop any individuals that don't have departure</span></span>
<span><span class="co"># times in df_departTime</span></span>
<span><span class="va">df_vanishBearing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">right_join</a></span><span class="op">(</span><span class="va">df_vanish</span>, <span class="va">df_departTime</span>, by <span class="op">=</span> <span class="st">"motusTagID"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">&gt;=</span> <span class="va">time_depart</span>,</span>
<span>         <span class="va">recvSiteName</span> <span class="op">==</span> <span class="va">depart.station</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig.norm <span class="op">=</span> <span class="op">(</span><span class="va">sig</span> <span class="op">-</span> <span class="op">(</span><span class="va">min.sig</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="va">max.sig</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="va">min.sig</span><span class="op">)</span><span class="op">)</span>, </span>
<span>         circ.bear <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circular/man/circular.html" class="external-link">circular</a></span><span class="op">(</span><span class="va">antBearing</span>, </span>
<span>                              type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"angles"</span><span class="op">)</span>, </span>
<span>                              units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"degrees"</span><span class="op">)</span>, </span>
<span>                              rotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"clock"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">motusTagID</span>, <span class="va">recvSiteName</span>, <span class="va">recvLat</span>, <span class="va">recvLon</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>vanish.bearing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html" class="external-link">weighted.mean</a></span><span class="op">(</span><span class="va">circ.bear</span>, <span class="va">sig.norm</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                           control.circular <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"angles"</span>, </span>
<span>                                                                   units <span class="op">=</span> <span class="st">"degrees"</span>, </span>
<span>                                                                   template <span class="op">=</span> <span class="st">"none"</span>, </span>
<span>                                                                   rotation <span class="op">=</span> <span class="st">"clock"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            minutes.used <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as.duration.html" class="external-link">as.duration</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://lubridate.tidyverse.org/reference/interval.html" class="external-link">%--%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span></code></pre></div>
<p>The resulting <code>df_vanish</code> dataframe contains the
<code>motusTagID</code>, the vanishing bearing of the tag, the time in
seconds/minutes used to estimate the bearing, and the receiver’s name
and coordinates. We can make a circular plot with points for the
individual vanishing bearings and an arrow for the mean bearing as
follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if you have many bearings/points, can use stack = TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/circular/man/plot.circular.html" class="external-link">plot.circular</a></span><span class="op">(</span><span class="va">df_vanishBearing</span><span class="op">$</span><span class="va">vanish.bearing</span>, zero <span class="op">=</span> <span class="va">pi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/circular/man/arrows.circular.html" class="external-link">arrows.circular</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">df_vanishBearing</span><span class="op">$</span><span class="va">vanish.bearing</span><span class="op">)</span>, zero <span class="op">=</span> <span class="va">pi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="vanishing-bearings_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="plot-the-vanishing-bearings-on-a-map">Plot the vanishing bearings on a map<a class="anchor" aria-label="anchor" href="#plot-the-vanishing-bearings-on-a-map"></a>
</h3>
<p>Mapping your vanishing bearing(s) with <code>ggspatial</code> can
also be a great way to visualize the departure direction of your
bird(s). Here we use OSM (Open Street map) maps to show the stations and
orientations of antennas that detected the bird during departure, along
with the orientation of the vanishing bearing.</p>
<p>First, we’ll filter our data to 16823 and then we’ll create some
spatial data frames to contain the bearings. We add a yellow point for
the stations with detections, yellow lines to represent antenna bearings
with detections, and a red line for the vanishing bearing:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_stations</span> <span class="op">&lt;-</span> <span class="va">df_vanish</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">motusTagID</span> <span class="op">==</span> <span class="fl">16823</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">recvSiteName</span>, <span class="va">antBearing</span>, <span class="va">port</span>, <span class="va">recvLon</span>, <span class="va">recvLat</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Id for each point</span></span>
<span>  </span>
<span><span class="co"># Create lines for bearings</span></span>
<span><span class="va">arr.sc</span> <span class="op">&lt;-</span> <span class="fl">0.03</span>  <span class="co"># determines length of the vectors for antenna bearings and vanishing bearing lines</span></span>
<span><span class="va">rad</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span> <span class="op">*</span> <span class="va">pi</span><span class="op">/</span><span class="fl">180</span><span class="op">}</span></span>
<span></span>
<span><span class="va">sf_stations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">df_stations</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"recvLon"</span>, <span class="st">"recvLat"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span><span class="va">sf_bearings_end</span> <span class="op">&lt;-</span> <span class="va">df_stations</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>xend <span class="op">=</span> <span class="va">recvLon</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/circular/man/rad.html" class="external-link">rad</a></span><span class="op">(</span><span class="va">antBearing</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">arr.sc</span><span class="op">)</span>,</span>
<span>         yend <span class="op">=</span> <span class="va">recvLat</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/circular/man/rad.html" class="external-link">rad</a></span><span class="op">(</span><span class="va">antBearing</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">arr.sc</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">recvLon</span>, <span class="op">-</span><span class="va">recvLat</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"xend"</span>, <span class="st">"yend"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sf_bearings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">sf_stations</span>, <span class="va">sf_bearings_end</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">recvSiteName</span>, <span class="va">antBearing</span>, <span class="va">port</span>, <span class="va">n</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_cast.html" class="external-link">st_cast</a></span><span class="op">(</span><span class="st">"LINESTRING"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create lines for vanishing bearings</span></span>
<span><span class="va">sf_vb_start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">df_vanishBearing</span>, <span class="va">motusTagID</span> <span class="op">==</span> <span class="fl">16823</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"recvLon"</span>, <span class="st">"recvLat"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span><span class="va">sf_vb_end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">df_vanishBearing</span>, <span class="va">motusTagID</span> <span class="op">==</span> <span class="fl">16823</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>xend <span class="op">=</span> <span class="va">recvLon</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/circular/man/rad.html" class="external-link">rad</a></span><span class="op">(</span><span class="va">vanish.bearing</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">arr.sc</span><span class="op">)</span>,</span>
<span>         yend <span class="op">=</span> <span class="va">recvLat</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/circular/man/rad.html" class="external-link">rad</a></span><span class="op">(</span><span class="va">vanish.bearing</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">arr.sc</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">recvLon</span>, <span class="op">-</span><span class="va">recvLat</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"xend"</span>, <span class="st">"yend"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sf_vanishing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">sf_vb_start</span>, <span class="va">sf_vb_end</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">motusTagID</span>, <span class="va">recvSiteName</span>, <span class="va">vanish.bearing</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_cast.html" class="external-link">st_cast</a></span><span class="op">(</span><span class="st">"LINESTRING"</span><span class="op">)</span>              </span>
<span></span>
<span><span class="co"># Plot!</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add map tiles</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_map_tile.html" class="external-link">annotation_map_tile</a></span><span class="op">(</span>zoom <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add scale bar</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_scale.html" class="external-link">annotation_scale</a></span><span class="op">(</span>location <span class="op">=</span> <span class="st">"br"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot stations</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sf_stations</span>, size <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"goldenrod"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add antenna bearings</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sf_bearings</span>, colour <span class="op">=</span> <span class="st">"goldenrod"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add vanishing bearings</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sf_vanishing</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">motusTagID</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Focus only on southern area</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">42.50</span>, <span class="fl">42.75</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">80.6</span>, <span class="op">-</span><span class="fl">80.2</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Map data from OpenStreetMap"</span><span class="op">)</span></span>
<span><span class="va">g</span></span></code></pre></div>
<p><img src="vanishing-bearings_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<pre><code><span><span class="co">##   |                                                                              |                                                                      |   0%  |                                                                              |========                                                              |  11%  |                                                                              |================                                                      |  22%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================                                       |  44%  |                                                                              |=======================================                               |  56%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================                |  78%  |                                                                              |==============================================================        |  89%  |                                                                              |======================================================================| 100%</span></span></code></pre>
<p>Lengths of the yellow and red lines do not represent antenna range or
exact path of the bird. For this departure, we have detections on two
other stations which corroborate the vanishing bearing.</p>
<p>If desired, you can print the map to file as follows:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="va">g</span>, file <span class="op">=</span> <span class="st">"16823vanishBearing.tiff"</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="literature-cited">Literature Cited<a class="anchor" aria-label="anchor" href="#literature-cited"></a>
</h2>
<p>Morbey, Y.E., K.A. Jonasson, J.E. Deakin, A.T. Beauchamp, and C.G.
Guglielmo. 2017. Studies of migratory birds and bats in southern
Ontario, 2014-2017 (Projects #20 and #50). Data accessed from the Motus
Wildlife Tracking System. Bird Studies Canada. Available: <a href="https://www.motus-wts.org" class="external-link uri">https://www.motus-wts.org</a>. Accessed: May 1, 2018.</p>
<p>Sjöberg, S., and C. Nilsson. 2015. Nocturnal migratory songbirds
adjust their travelling direction aloft: evidence from a radiotelemetry
and radar study. Biology Letters 11:20150337.</p>
<blockquote>
<p><strong>What Next?</strong> <a href="index.html">Explore all
articles</a></p>
</blockquote>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Birds Canada, John Brzustowski, Denis Lepage.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
